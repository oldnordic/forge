# Plan: Directory Structure

**Phase**: 01 - Project Organization
**Step**: 01-02
**Status**: ðŸ“‹ Planned
**Created**: 2025-12-30

---

## Objective

Create the standard directory structure for the ForgeKit workspace.

---

## Tasks

### 1. Create Core Directories

```bash
# Source directories
mkdir -p forge_core/src/{graph,search,cfg,edit,analysis,storage}
mkdir -p forge_runtime/src
mkdir -p forge_agent/src

# Test directories
mkdir -p forge_core/tests
mkdir -p forge_runtime/tests
mkdir -p forge_agent/tests
mkdir -p tests/{integration,fixtures}

# Documentation
mkdir -p docs
mkdir -p examples
```

**Acceptance:**
- [ ] All directories created
- [ ] Structure matches ARCHITECTURE.md

### 2. Create Placeholder Files

**Files to create:**
- `forge_core/src/lib.rs`
- `forge_core/src/graph/mod.rs`
- `forge_core/src/search/mod.rs`
- `forge_core/src/cfg/mod.rs`
- `forge_core/src/edit/mod.rs`
- `forge_core/src/analysis/mod.rs`
- `forge_core/src/storage/mod.rs`
- `forge_core/src/error.rs`
- `forge_core/src/types.rs`
- `forge_runtime/src/lib.rs`
- `forge_agent/src/lib.rs`

**Content for each lib.rs:**
```rust
//! ForgeKit - [Component Name]
//!
//! [Brief description]

// Placeholder for compilation
```

**Acceptance:**
- [ ] All lib.rs files created
- [ ] All mod.rs files created
- [ ] `cargo build` succeeds

### 3. Create Basic Module Files

**forge_core/src/types.rs:**
```rust
//! Core types for ForgeKit.

use std::path::PathBuf;

/// Stable identifier for a symbol across reindexing
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash)]
pub struct SymbolId(pub i64);

/// Stable identifier for a CFG block
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash)]
pub struct BlockId(pub i64);

/// Source code location
#[derive(Clone, Debug, PartialEq, Eq)]
pub struct Location {
    pub file_path: PathBuf,
    pub byte_start: u32,
    pub byte_end: u32,
    pub line_number: usize,
}

/// Byte span
#[derive(Clone, Copy, Debug, PartialEq, Eq)]
pub struct Span {
    pub start: u32,
    pub end: u32,
}
```

**forge_core/src/error.rs:**
```rust
//! Error types for ForgeKit.

use std::path::PathBuf;

/// Main error type for ForgeKit
#[derive(thiserror::Error, Debug)]
pub enum ForgeError {
    #[error("Database error: {0}")]
    DatabaseError(String),

    #[error("Symbol not found: {0}")]
    SymbolNotFound(String),

    #[error("Invalid query: {0}")]
    InvalidQuery(String),

    #[error("Edit conflict in {file:?} at {span:?}")]
    EditConflict { file: PathBuf, span: Span },

    #[error("Verification failed: {0}")]
    VerificationFailed(String),

    #[error("Policy violation: {0}")]
    PolicyViolation(String),

    #[error("Backend not available: {0}")]
    BackendNotAvailable(String),
}
```

**Acceptance:**
- [ ] Core types defined
- [ ] Error types defined
- [ ] Both files compile

### 4. Create Test Infrastructure

**forge_core/tests/common/mod.rs:**
```rust
//! Test utilities for ForgeKit.

use std::path::PathBuf;

pub struct TestForge {
    pub temp_dir: PathBuf,
    pub db_path: PathBuf,
}

impl TestForge {
    pub fn new() -> Self {
        // Create temp directory
        // Initialize empty database
    }

    pub async fn close(self) {
        // Cleanup
    }
}
```

**Acceptance:**
- [ ] Test utilities compile
- [ ] Test fixtures directory exists

### 5. Update .gitignore

**Additions:**
```
# Forge database
.forge/
*.db

# Test temp
tests/fixtures/temp/
```

**Acceptance:**
- [ ] .gitignore updated
- [ ] Build artifacts ignored
- [ ] Test databases ignored

---

## Success Criteria

- [ ] All directories created
- [ ] All placeholder files exist
- [ ] `cargo build --workspace` succeeds
- [ ] `cargo test --workspace` succeeds
- [ ] .gitignore is complete

---

## File Tree (Target)

```
forge/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ LICENSE
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ AGENTS.md
â”œâ”€â”€ .gitignore
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ARCHITECTURE.md
â”‚   â”œâ”€â”€ API.md
â”‚   â”œâ”€â”€ PHILOSOPHY.md
â”‚   â”œâ”€â”€ DEVELOPMENT_WORKFLOW.md
â”‚   â”œâ”€â”€ CONTRIBUTING.md
â”‚   â””â”€â”€ ROADMAP.md
â”œâ”€â”€ .planning/
â”‚   â”œâ”€â”€ milestones/
â”‚   â””â”€â”€ phases/
â”œâ”€â”€ forge_core/
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ lib.rs
â”‚       â”œâ”€â”€ types.rs
â”‚       â”œâ”€â”€ error.rs
â”‚       â”œâ”€â”€ graph/
â”‚       â”‚   â””â”€â”€ mod.rs
â”‚       â”œâ”€â”€ search/
â”‚       â”‚   â””â”€â”€ mod.rs
â”‚       â”œâ”€â”€ cfg/
â”‚       â”‚   â””â”€â”€ mod.rs
â”‚       â”œâ”€â”€ edit/
â”‚       â”‚   â””â”€â”€ mod.rs
â”‚       â”œâ”€â”€ analysis/
â”‚       â”‚   â””â”€â”€ mod.rs
â”‚       â””â”€â”€ storage/
â”‚           â””â”€â”€ mod.rs
â”œâ”€â”€ forge_runtime/
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ lib.rs
â”œâ”€â”€ forge_agent/
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ lib.rs
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ fixtures/
â””â”€â”€ examples/
```

---

*Last updated: 2025-12-30*
