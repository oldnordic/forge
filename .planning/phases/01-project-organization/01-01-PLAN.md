# Plan: Workspace Setup

**Phase**: 01 - Project Organization
**Step**: 01-01
**Status**: ðŸ“‹ Planned
**Created**: 2025-12-30

---

## Objective

Create a Cargo workspace with three member crates and proper dependency configuration.

---

## Tasks

### 1. Create Workspace Cargo.toml

**File**: `Cargo.toml` (root)

```toml
[workspace]
resolver = "3"
members = [
    "forge_core",
    "forge_runtime",
    "forge_agent",
]

# Shared build profile
[profile.release]
opt-level = 3
codegen-units = 1
lto = "thin"
debug = false
panic = "abort"

[profile.bench]
inherits = "release"
debug = true

[profile.test]
opt-level = 2
```

**Acceptance:**
- [ ] Workspace configuration is valid
- [ ] Build profiles are defined
- [ ] Resolver version is current

### 2. Create forge_core/Cargo.toml

**File**: `forge_core/Cargo.toml`

```toml
[package]
name = "forge-core"
version = "0.1.0"
edition = "2021"
license = "GPL-3.0-or-later"
repository = "https://github.com/oldnordic/forge"
description = "Deterministic code intelligence SDK - Core library"

[lib]
name = "forge_core"
path = "src/lib.rs"

[dependencies]
sqlitegraph = { version = "1.5", default-features = false }
tokio = { version = "1", features = ["full"] }
anyhow = "1"
serde = { version = "1", features = ["derive"] }
serde_json = "1"
thiserror = "1"

[dev-dependencies]
tokio = { version = "1", features = ["test-util"] }
```

**Acceptance:**
- [ ] Package metadata complete
- [ ] Dependencies specified
- [ ] Library path configured

### 3. Create forge_runtime/Cargo.toml

**File**: `forge_runtime/Cargo.toml`

```toml
[package]
name = "forge-runtime"
version = "0.1.0"
edition = "2021"
license = "GPL-3.0-or-later"
repository = "https://github.com/oldnordic/forge"
description = "ForgeKit runtime layer - Indexing and caching"

[lib]
name = "forge_runtime"
path = "src/lib.rs"

[dependencies]
forge-core = { path = "../forge_core" }
sqlitegraph = { version = "1.5", default-features = false }
tokio = { version = "1", features = ["full"] }
notify = "8"
```

**Acceptance:**
- [ ] Package metadata complete
- [ ] Depends on forge_core
- [ ] File watching configured

### 4. Create forge_agent/Cargo.toml

**File**: `forge_agent/Cargo.toml`

```toml
[package]
name = "forge-agent"
version = "0.1.0"
edition = "2021"
license = "GPL-3.0-or-later"
repository = "https://github.com/oldnordic/forge"
description = "ForgeKit agent layer - Deterministic AI loop"

[lib]
name = "forge_agent"
path = "src/lib.rs"

[dependencies]
forge-core = { path = "../forge_core" }
sqlitegraph = { version = "1.5", default-features = false }
tokio = { version = "1", features = ["full"] }
serde = { version = "1", features = ["derive"] }
```

**Acceptance:**
- [ ] Package metadata complete
- [ ] Depends on forge_core
- [ ] Minimal dependencies

### 5. Verify Build

**Command**: `cargo build --workspace`

**Acceptance:**
- [ ] All three crates compile
- [ ] No warnings
- [ ] Build completes successfully

---

## Success Criteria

- [ ] `cargo build --workspace` succeeds
- [ ] `cargo test --workspace` succeeds
- [ ] All crates visible to workspace
- [ ] Dependencies resolve correctly

---

## Notes

- sqlitegraph dependency should be flexible for SQLite vs Native V3
- tokio is required for all async operations
- thiserror provides derive macros for ForgeError

---

*Last updated: 2025-12-30*
