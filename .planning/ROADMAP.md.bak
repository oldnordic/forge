# ForgeKit Roadmap

**Project**: ForgeKit
**Version**: 0.1.0
**Status**: Active Development
**Last Updated**: 2026-02-12

---

## Roadmap Overview

This roadmap defines the phased development plan for ForgeKit from foundation (v0.1) through stable release (v1.0).

### Milestone Summary

| Milestone | Focus | Duration | Status |
|-----------|--------|-----------|---------|
| v0.1 Foundation | Project scaffolding and API design | 1 week | Complete |
| v0.2 Core SDK | SQLiteGraph integration and tool bindings | 4 weeks | Planned |
| v0.3 Runtime | Indexing, caching, file watching | 3 weeks | Complete |
| v0.4 Agent | Deterministic AI loop and policies | 3 weeks | Complete |
| v0.5 Plan Kernel (C Mode) | Native-V3 plan graph, pub/sub, handoff | 3-4 weeks | Planned |
| v1.0 Stable | Production-ready release | - | Planned |
| v2.0 OdinCode | Multi-agent swarm with Native-V3 | 4-6 weeks | Planned |
| v3.0 Long-term | Multi-language support, distributed analysis | - | Planned |

---

## Milestone v0.1: Foundation

**Goal**: Establish project foundation with proper workspace structure, documentation, and basic API design.

**Status**: Complete (100%)

### Phase Summary

| Phase | Name | Duration | Status |
|--------|---------|----------|
| 01 | Project Organization | 1 day | Complete |
| 02 | Core SDK Stubs | 2 days | Complete |
| 03 | Test Infrastructure | 1 day | Complete |
| 04 | Documentation Review | 1 day | Complete | 2026-02-12 |

### Phase 01: Project Organization

**Status**: Complete

#### Tasks

- [x] 01-01: Workspace Setup
  - [x] Create root `Cargo.toml` with workspace members
  - [x] Create `forge_core/Cargo.toml`
  - [x] Create `forge_runtime/Cargo.toml`
  - [x] Create `forge_agent/Cargo.toml`
  - [x] Verify `cargo build --workspace` succeeds

- [x] 01-02: Directory Structure
  - [x] Create all source directories
  - [x] Create test directories
  - [x] Create documentation directories
  - [x] Update `.gitignore`

### Phase 02: Core SDK Stubs

**Status**: Complete

#### Tasks

- [x] 02-01: Core Types
  - [x] Define `SymbolId`, `BlockId`, `PathId`
  - [x] Define `Location`, `Span`
  - [x] Define `SymbolKind`, `ReferenceKind`, `PathKind`
  - [x] Define `Language` enum

- [x] 02-02: Error Types
  - [x] Define `ForgeError` enum
  - [x] Implement `std::error::Error`
  - [x] Implement `std::fmt::Display`
  - [x] Add `From<>` implementations

- [x] 02-03: Graph Module Stub
  - [x] Define `GraphModule` struct
  - [x] Stub `find_symbol()`, `callers_of()`, `references()`
  - [x] Stub `reachable_from()`, `cycles()`

- [x] 02-04: Search Module Stub
  - [x] Define `SearchModule` struct
  - [x] Define `SearchBuilder` type
  - [x] Stub filter methods and `execute()`

- [x] 02-05: CFG Module Stub
  - [x] Define `CfgModule` struct
  - [x] Define `PathBuilder` type
  - [x] Stub `dominators()`, `loops()`

- [x] 02-06: Edit Module Stub
  - [x] Define `EditModule` struct
  - [x] Define `EditOperation` trait
  - [x] Define `RenameOperation`, `DeleteOperation`

### Phase 03: Test Infrastructure

**Status**: In Progress (5 plans created)

**Goal:** Build comprehensive test infrastructure for forge_core with 80%+ coverage targeting ~100 new tests.

#### Plans

- [ ] 03-01-PLAN.md — Core types and common utilities (40 tests, Wave 1)
- [ ] 03-02-PLAN.md — Forge/ForgeBuilder tests and integration infrastructure (28 tests, Wave 1)
- [ ] 03-03a-PLAN.md — Watcher and Indexing tests (12 tests, Wave 2)
- [ ] 03-03b-PLAN.md — Cache and Pool tests (12 tests, Wave 2)
- [ ] 03-03c-PLAN.md — Runtime orchestration and integration tests (10 tests, Wave 3)

**Total: 102 tests planned**

#### Tasks (Legacy - superseded by plans above)

- [ ] 03-01: Test Utilities
  - [x] Create `tests/common/mod.rs` — Already exists
  - [ ] Implement `TestForge` fixture builder — Already exists as `test_forge()`
  - [x] Implement temp directory helpers — Already exists
  - [ ] Implement assert helpers — Planned for 03-01

- [ ] 03-02: Unit Tests
  - [ ] Add tests for `types.rs` — Planned for 03-01
  - [ ] Add tests for `error.rs` — Already has 3 tests
  - [ ] Add tests for each module stub — Most modules already tested

- [ ] 03-03: Integration Tests
  - [ ] Create `tests/integration/` directory — Planned for 03-02
  - [ ] Write builder tests — Planned for 03-02
  - [ ] Write module accessor tests — Planned for 03-02

### Phase 04: Documentation Review

**Status**: Pending

#### Tasks

- [x] 04-01: README Validation
  - [x] Verify all examples compile
  - [x] Test quickstart example
  - [x] Check all links

- [x] 04-02: API Documentation
  - [x] Complete `docs/API.md`
  - [x] Verify rustdoc builds
  - [x] Add examples to all public items

- [x] 04-03: Architecture Review
  - [x] Verify ARCHITECTURE.md accuracy
  - [x] Update diagrams
  - [x] Cross-check with code

- [x] 04-04: Cross-Reference Check
  - [x] Verify all internal links
  - [x] Check external references
  - [x] Ensure consistent terminology

### Exit Criteria

Milestone complete when:
- [x] `cargo build --workspace` succeeds
- [x] `cargo test --workspace` passes
- [x] All documentation reviewed
- [x] At least one example runs

---

## Milestone v0.2: Core SDK Implementation

**Goal**: Implement actual functionality with SQLiteGraph integration and tool bindings.

**Status**: Planned

**Estimated Duration**: 4 weeks

### Phase Breakdown

| Phase | Focus | Duration | Dependencies |
|--------|---------|--------------|
| 05 | Storage Layer | 1 week | v0.1 complete |
| 06 | Graph & Search | 1 week | Phase 05 |
| 07 | CFG & Edit | 1 week | Phase 05 |
| 08 | Analysis & Integration Tests | 1 week | Phases 06-07 |

### Phase 05: Storage Layer

**Tasks:**
- [ ] Implement `UnifiedGraphStore` with SQLiteGraph backend
- [ ] Add connection pooling
- [ ] Implement prepared statement caching
- [ ] Add transaction management
- [ ] Write migration system

### Phase 06: Graph & Search

**Tasks:**
- [ ] Integrate Magellan for graph operations
- [ ] Implement all `GraphModule` methods
- [ ] Integrate LLMGrep for search
- [ ] Implement `SearchModule` query execution
- [ ] Add comprehensive tests

### Phase 07: CFG & Edit

**Tasks:**
- [ ] Integrate Mirage for CFG operations
- [ ] Implement all `CfgModule` methods
- [ ] Integrate Splice for editing
- [ ] Implement `EditOperation` trait methods
- [ ] Add edit workflow tests

### Phase 08: Analysis & Integration

**Tasks:**
- [ ] Implement `AnalysisModule` composite operations
- [ ] Write end-to-end integration tests
- [ ] Add performance benchmarks
- [ ] Create example programs

### Exit Criteria

- [ ] All module operations functional
- [ ] Integration tests pass
- [ ] Performance targets met
- [ ] Examples demonstrate capabilities

---

## Milestone v0.3: Runtime Layer

**Goal**: Implement indexing, caching, and file watching.

**Status**: Planned

**Estimated Duration**: 3 weeks

### Phase Breakdown

| Phase | Focus | Duration | Dependencies |
|--------|---------|--------------|
| 09 | Indexing System | 1 week | v0.2 complete |
| 10 | Caching Layer | 1 week | Phase 09 |
| 11 | File Watching | 1 week | Phase 09 |

### Phase 09: Indexing System

**Tasks:**
- [ ] Design incremental index format
- [ ] Implement index scheduler
- [ ] Add progress tracking
- [ ] Create index health checks

### Phase 10: Caching Layer

**Tasks:**
- [ ] Design cache architecture
- [ ] Implement symbol cache
- [ ] Implement CFG cache
- [ ] Add TTL management
- [ ] Create cache invalidation

### Phase 11: File Watching

**Tasks:**
- [ ] Integrate `notify` crate
- [ ] Implement debounce logic
- [ ] Add selective reindexing
- [ ] Create watch configuration

### Exit Criteria

- [ ] Automatic reindexing works
- [ ] Cache improves performance
- [ ] Watch mode handles large repos
- [ ] Memory usage acceptable

---

## Milestone v0.4: Agent Layer

**Goal**: Implement deterministic AI orchestration loop.

**Status**: Planned

**Estimated Duration**: 3 weeks

### Phase Breakdown

| Phase | Focus | Duration | Dependencies |
|--------|---------|--------------|
| 12 | Agent Core | 1 week | v0.3 complete |
| 13 | Policy System | 1 week | Phase 12 |
| 14 | LLM Integration (Optional) | 1 week | Phase 12 |
| 15 | Provider Adapters | 2 weeks | v0.4 complete |
| 16 | Runtime Expansion | 1 week | v0.4 complete |
| 17 | ForgeTesting Harness | 1 week | v0.4 complete |
| 18 | OdinCode Integration | 2 weeks | v0.5 complete |
| 19 | Production Hardening | 2 weeks | v1.0 complete |

### Phase 12: Agent Core

**Tasks:**
- [ ] Implement agent loop structure
- [ ] Implement observe phase
- [ ] Implement plan phase
- [ ] Implement mutate phase
- [ ] Implement verify phase
- [ ] Implement commit phase

### Phase 13: Policy System

**Tasks:**
- [ ] Define policy DSL
- [ ] Implement built-in policies
- [ ] Create policy validator
- [ ] Add policy composition
- [ ] Document policy patterns

### Phase 14: LLM Integration

**Tasks:**
- [ ] Design pluggable LLM backend
- [ ] Implement prompt generator
- [ ] Add response parser
- [ ] Create fallback logic
- [ ] Add safety validation

### Phase 15: Provider Adapters
- [ ] Design pluggable LLM backend
- [ ] Implement prompt generator
- [ ] Add response parser
- [ ] Create fallback logic
- [ ] Add safety validation

### Exit Criteria

- [ ] Agent completes full loop
- [ ] Policies enforced correctly
- [ ] LLM integration optional
- [ ] End-to-end tests pass

---

## Milestone v0.5: Polish

**Goal**: Performance optimization, documentation completion, and example programs.

**Status**: Planned

**Estimated Duration**: 2 weeks

### Tasks

**Performance:**
- [ ] Profile critical paths
- [ ] Optimize hot functions
- [ ] Add memory pools
- [ ] Improve cache hit rates

**Documentation:**
- [ ] Complete API reference
- [ ] Write tutorial guide
- [ ] Add migration guide
- [ ] Create troubleshooting docs

**Examples:**
- [ ] Basic query example
- [ ] Rename refactoring example
- [ ] CFG analysis example
- [ ] Agent usage example

**Quality:**
- [ ] Fix all clippy warnings
- [ ] Achieve 80%+ coverage
- [ ] Add security audit
- [ ] Performance benchmarks

### Exit Criteria

- [ ] Performance targets met
- [ ] Documentation complete
- [ ] Examples work
- [ ] Ready for v1.0

---

## Milestone v0.5: Plan Kernel (C Mode)

**Goal**: Implement deterministic, graph-based multi-agent orchestration with Native-V3 plan graph.

**Status**: Planned
**ADR**: [2026-02-forgekit-agentic-plan-kernel.md](.planning/adr/2026-02-forgekit-agentic-plan-kernel.md)

**Estimated Duration**: 3-4 weeks

### Architecture Overview

The Plan Kernel is the "C Mode" deterministic orchestration layer:

```
┌─────────────────────────────────────────────────────────────────────┐
│                    Application Layer                         │
│           (IDE, CLI, OdinCode, Custom Tools)                  │
└────────────────────────────┬───────────────────────────────────────────┘
                         │
┌────────────────────────────┴───────────────────────────────────────┐
│                       Native-V3 Plan Graph                      │
│                                                                   │
│  Nodes: Plan, Step, Artifact, Risk, Handoff                    │
│  Edges: PLAN_HAS_STEP, STEP_DEPENDS_ON, STEP_TOUCHES_FILE   │
│                                                                  │
│  Properties: Append-only, Immutable Proofs, Queryable              │
└────────────────────────────┬───────────────────────────────────────────┘
                         │
┌────────────────────────────┴───────────────────────────────────────┐
│                   Pub/Sub Event Bus                                 │
│                                                                   │
│  Events: PLAN_CREATED, STEP_STARTED, PATCH_APPLIED,              │
│          VERIFY_OK, HANDOFF_EMITTED                                 │
│                                                                   │
│  Subscribers: Planner Agent, Worker Agent, Auditor Agent               │
└────────────────────────────┬───────────────────────────────────────────┘
                         │
┌────────────────────────────┴───────────────────────────────────────┐
│                   File Lease System                                    │
│  Prevents concurrent edits to same file/module                       │
└───────────────────────────────────────────────────────────────────────┘
```

### Phase Breakdown

| Phase | Focus | Duration | Dependencies |
|--------|---------|--------------|
| 20 | Native-V3 Plan Graph | 1 week | v0.4 complete |
| 21 | Deterministic Scoreboard | 1 week | Phase 20 |
| 22 | Pub/Sub Event Bus | 1 week | Phase 20 |
| 23 | Agent Implementation | 1 week | Phases 21-22 |
| 24 | Handoff Protocol | 1 week | Phase 22 |
| 25 | File Lease System | 1 week | Phase 22 |

### Phase 20: Native-V3 Plan Graph

**Tasks:**
- [ ] Define Plan node schema (id, goal, constraints, success_criteria, created_at)
- [ ] Define Step node schema (id, plan_id, order, scope, status)
- [ ] Define Artifact node schema (id, type=file|symbol|patch|test, hash)
- [ ] Define Risk node schema (id, description, severity)
- [ ] Implement edges: PLAN_HAS_STEP, STEP_DEPENDS_ON, STEP_TOUCHES_FILE, STEP_PRODUCES_PATCH, STEP_BLOCKED_BY, PLAN_SUPERSEDES
- [ ] Enforce append-only property
- [ ] Add graph queries for plan traversal

### Phase 21: Deterministic Scoreboard

**Tasks:**
- [ ] Define StepScore struct with objective metrics
- [ ] Implement compile_ok verification
- [ ] Implement tests_passed/tests_total tracking
- [ ] Implement warnings_delta, clippy_delta
- [ ] Implement diff_size_loc calculation
- [ ] Implement time_cost_ms tracking
- [ ] Implement rollback_count, regression_hits
- [ ] Add deterministic score computation function
- [ ] Store scores as immutable graph nodes

### Phase 22: Pub/Sub Event Bus

**Tasks:**
- [ ] Define PlanEvent enum (PLAN_CREATED, STEP_STARTED, PATCH_PROPOSED, PATCH_APPLIED, VERIFY_OK, VERIFY_FAILED, STEP_COMPLETED, PLAN_RESCOPED, HANDOFF_EMITTED)
- [ ] Implement event publisher in Native-V3
- [ ] Implement event subscription mechanism
- [ ] Add AgentRole trait (Planner, Worker, Auditor)
- [ ] Implement event filtering by role
- [ ] Add event replay capability

### Phase 23: Agent Implementation

**Tasks:**
- [ ] Implement PlannerAgent (create_plan, rescope)
- [ ] Implement WorkerAgent (execute_step)
- [ ] Implement AuditorAgent (audit_step)
- [ ] Add agent lifecycle management
- [ ] Implement agent coordination via events
- [ ] Add agent health monitoring

### Phase 24: Handoff Protocol

**Tasks:**
- [ ] Define HandoffSummary struct
- [ ] Implement token budget monitoring (100k/128k trigger)
- [ ] Add touched_files + hashes tracking
- [ ] Add next_3_actions generation
- [ ] Add minimal_required_queries
- [ ] Implement handoff emit/load cycle
- [ ] Add handoff verification

### Phase 25: File Lease System

**Tasks:**
- [ ] Define FileLease struct (file_path, holder, acquired_at, expires_at)
- [ ] Implement lease acquisition API
- [ ] Implement lease renewal/expiration
- [ ] Add conflict detection (block or retry)
- [ ] Enforce lease requirement for file edits
- [ ] Add lease query API

### Exit Criteria

- [ ] Plan Graph schema implemented in Native-V3
- [ ] StepScore computation is deterministic and objective
- [ ] Pub/Sub event bus functional
- [ ] Agent roles (Planner, Worker, Auditor) working
- [ ] File lease system prevents concurrent edits
- [ ] HANDOFF_SUMMARY defined and operational
- [ ] Immutable proofs property enforced
- [ ] Deterministic replay produces identical results

### Forge Runtime API Surface

```rust
// Planning
forge.plan.create(goal: &str, constraints: Vec<Constraint>) -> PlanId
forge.plan.next_steps(plan_id: PlanId) -> Vec<StepId>
forge.plan.rescope(plan_id: PlanId, reason: RescopeReason) -> PlanId

// Execution
forge.step.execute(step_id: StepId) -> Result<PatchSet>
forge.step.score(step_id: StepId) -> StepScore

// Handoff
forge.handoff.emit(step_id: StepId, budget_state: TokenBudget) -> HandoffId

// Query
forge.graph.query(query: GraphQuery) -> QueryResult
forge.graph.file_lease(path: &Path) -> Option<Lease>
```

---

## Milestone v1.0: Stable Release

---

## Milestone v1.0: Stable Release

**Goal**: Production-ready ForgeKit SDK.

**Status**: Planned

**Release Criteria:**

**Functionality:**
- [ ] All v0.2-v0.5 features complete
- [ ] No stub implementations remaining
- [ ] All integration tests pass
- [ ] Performance targets met

**Quality:**
- [ ] Zero known critical bugs
- [ ] Zero memory safety issues
- [ ] Full documentation coverage
- [ ] Successful security audit

**Ecosystem:**
- [ ] Published to crates.io
- [ ] CI/CD pipeline
- [ ] Examples in repository
- [ ] Contributor guide complete

---

## Milestone v2.0: OdinCode - Multi-Agent Swarm

**Goal**: Production multi-agent code reasoning system using Plan Kernel (C Mode) as orchestration layer.

**Status**: Planned
**Depends on**: v0.5 Plan Kernel complete
**Estimated Duration**: 4-6 weeks

### Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                      OdinCode (User Agent)                  │
│                           ↓                              │
│  ┌─────────────────────────────────────────────────────┐ │
│  │          Plan Kernel (C Mode)          │ │
│  │  ┌───────────────────────────────────────────────┐ │ │
│  │  │         Native-V3 Plan Graph          │ │
│  │  │  Plans, Steps, Artifacts, Risks, Handoffs  │ │ │
│  │  │  Append-only, Immutable Proofs              │ │
│  │  └───────────────────────────────────────────────┘ │ │
│  │                  ↓                    ↑             │ │
│  │  ┌──────────────┐        ┌─────────────┐    │ │
│  │  │ Pub/Sub Bus  │        │ Scoreboard   │    │ │
│  │  │ Events       │        │ Deterministic │    │ │
│  │  └──────────────┘        │ Scoring      │    │ │
│  │         ↓                  └─────────────┘    │ │
│  │  ┌──────────────────────────────────────────┐     │ │
│  │  │     Agent Swarm (Role-Based)    │     │ │
│  │  │  Planner │ Worker │ Auditor │     │ │
│  │  └──────────────────────────────────────────┘     │ │
│  └─────────────────────────────────────────────────────┘ │
└────────────────────────────┬─────────────────────────────────────┘
                           ↓
                  ┌────────────────────┐
                  │  File Lease      │
                  │  System          │
                  └────────────────────┘
```

### Phase Breakdown

| Phase | Focus | Duration | Dependencies |
|--------|---------|--------------|
| 30 | Multi-Agent Coordination | 1 week | v0.5 complete |
| 31 | Swarm Orchestration | 1 week | Phase 30 |
| 32 | Advanced Handoff | 1 week | Phase 30 |
| 33 | Swarm Telemetry | 1 week | Phase 31 |
| 34 | Production Agents | 1 week | Phase 32 |
| 35 | OdinCode Integration | 2 weeks | Phase 34 |

### Key Capabilities

**Multi-Agent Coordination:**
- Multiple Planner agents work on independent sub-plans
- Worker agents execute steps in parallel (with file lease isolation)
- Auditor agents verify independently
- Swarm scales to 10+ concurrent agents

**Advanced Handoff:**
- Hierarchical handoffs (sub-plan handoff without stopping swarm)
- Progressive handoff (warm handoff while current agent continues)
- Handoff merge (multiple agent results combined)

**Swarm Telemetry:**
- Real-time plan progress visualization
- Agent health and performance monitoring
- Bottleneck detection (blocked steps, lease contention)
- Swarm-level metrics (throughput, latency)

**Production Agents:**
- Refactoring Agent (specialized in rename/extract)
- Test Generation Agent (specialized in test creation)
- Analysis Agent (specialized in impact/dead-code analysis)
- Migration Agent (specialized in version upgrades)

### Success Criteria

- [ ] Multi-agent coordination functional
- [ ] Swarm scales to 10+ concurrent agents
- [ ] Advanced handoff (hierarchical, progressive, merge)
- [ ] Telemetry dashboard operational
- [ ] Production agents deployed
- [ ] OdinCode can drive full swarm
- [ ] Performance: 100+ steps/minute throughput
- [ ] Reliability: <1% handoff failure rate

---

## Future Considerations (Post-v2.0)

| Feature | Priority | Complexity | Notes |
|----------|-----------|--------------|--------|
| Native V3 backend | Medium | High | External dependency |
| Language Server | Low | High | Separate project |
| Python support | Medium | Medium | Parser availability |
| WebAssembly | Low | Medium | Browser support |
| Distributed analysis | Low | Very High | Research needed |

### Dependent Projects

| Project | Impact | Status |
|----------|----------|--------|
| sqlitegraph | Critical | Active |
| magellan | Required | Stable |
| llmgrep | Required | Stable |
| mirage | Optional | Stable |
| splice | Required | Stable |

---

## Timeline Visualization

```
v0.1 Foundation        v0.2 Core SDK         v0.3 Runtime    v0.4 Agent    v0.5 Polish     v1.0 Stable
    |                      |                        |                   |              |              |
Week 1                  |                        |                   |              |              |
Phase 01-02            |                        |                   |              |              |
                        |                        |                   |              |              |
Week 2-5               |                        |                   |              |              |
Phase 03-04            |                        |                   |              |              |
(Found Complete)         |                        |                   |              |              |
                        |                        |                   |              |              |
Week 6-9               |                        |                   |              |              |
Phases 05-08           |                        |                   |              |              |
(Core SDK Impl)         |                        |                   |              |              |
                                                 |                   |              |              |
Week 10-12                                      |                   |              |              |
Phases 09-11                                    |                   |              |              |
(Runtime Layer)                                  |                   |              |              |
                                                                     |              |
Week 13-15                                                          |              |
Phases 12-14                                                        |              |
(Agent Layer)                                                       |              |
                                                                                  |
Week 16-17                                                                 |
Phase 15                                                                   |
(Polish)                                                                    |
                                                                                            |
Week 18                                                                              |
v1.0 Release                                                                      |
```

---

## Risk Register

| Risk | Impact | Probability | Mitigation |
|-------|---------|--------------|------------|
| sqlitegraph schema changes | High | Medium | Pin version, track upstream |
| Tool integration complexity | High | High | Prefer library over CLI |
| Performance targets | Medium | Medium | Early benchmarking |
| Agent safety | High | Low | Strict policy enforcement |
| Documentation drift | Low | Medium | Continuous review |

### Phase 15: Tool Integration
**Goal:** Export magellan/llmgrep/mirage/splice functions as library APIs in forge_core

**Status:** Planned

**Depends on:** Phase 04 (Agent Layer)

**Plans:** 0 (run `/gsd:plan-phase 16` to create)

**Goal:** [To be planned]
**Depends on:** Phase 14
**Plans:** 0 plans

Plans:
- [ ] TBD (run /gsd:plan-phase 15 to break down)

### Phase 16: --name 05-tool-integration --after 04 --ordinal 5

**Goal:** [To be planned]
**Depends on:** Phase 15
**Plans:** 0 plans

Plans:
- [ ] TBD (run /gsd:plan-phase 16 to break down)

---

*Last updated: 2026-02-12*
